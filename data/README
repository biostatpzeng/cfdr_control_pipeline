*****************************************************************
*--  Summary of data sets                                     --*
*--                                                           --*
*--  'Accurate error control in high dimensional association  --*
*--  testing using conditional false discovery rates'         --*
*--                                                           --*
*--  James Liley and Chris Wallace                            --*
*--  2018                                                     --*
*****************************************************************

This folder contains three .RData files

cfdrsimmatrix.RData: a matrix of simulation results
gwas_data.RData: GWAS data for ImmunoChip studies on JIA/T1D
gwas_cfdr_data.RData: L-regions and v-values for cFDR analysis

The file gwas_cfdr_data.RData is generated by the script in 

../code/analysis_control.R

The objects in these files are summarised below.



### cfdrsimmatrix.RData ###

This file contains a single object called rx. This is a data
frame with the following columns. Some columns are only 
relevant to our second paper, 'New estimators for conditional
false discovery rates improve power and smoothness', but their
explanation is included here for completeness. Variables are 
explained in the supplementary material, section 'Simulation 
protocol'. Simulations are oversampled with n1p+n1pq=0.

[1] seed: random seed used to generate the simulation. To 
  reproduce the results of a given run of the simulation, run
  the script ../code/run_simulation.R with the variable 'seed'
  set to this value.
[2] alpha: FDR control level. Always 0.1 for this data
[3] N: number of variables
[4] dist1: TRUE effect size distribution for non-null effects.
  1 corresponds to normal, 2 to t (3df), 3 to Cauchy.
[5] dist2: ASSUMED effect size distribution for modelling 
  Z_Q|HP0 and integrating over L. Always 1 (normal).
[6] n1p: number of variables associated with P
[7] n1q: number of variables associated with Q
[8] n1pq: number of variables associated with P and Q
[9] sp: scale of effect size distribution for variables 
  associated with P
[10] sq: scale of effect size distribution for variables 
  associated with Q
[11-17] fit_{x}: parameters of bivariate Gaussian-mixture 
  model for distribution of P,Q. Only relevant to second 
  paper. {x} can be in {pi0,pi1,pi2,tau1,tau2,sigma1,sigma2}.
[18] fit_conv: indicator for convergence of mixture-Gaussian 
  model. Only relevant for paper 2.
[19-20] {x}_null: parameters of bivariate Gaussian fitted to 
  distribution of Q|P>0.5. {x} can be in {pi0,sigma}.
[21-214] {A}_cf{B}_fdr{C}_adj{D}_dist{E}_fold{F}: results 
  from simulations. 
  {A}: either fdp or tdr
  {B}: 1,2, or 3: type of cfdr estimator. Paper 1 only uses B=1.
    Other estimators are relevant to paper 2.
  {C}: 1,2,3,3b, or 4: type of FDR control method. Method 4 
    (leave-one-out) is deprecated for B=2/3, but C=4 is used to
    code for 'local' fdp/tdr control using method 3b for B=2.
  {D}: 0 or 1: include estimate of Pr(Q<q|HP0) in estimator of
    cFDR. Only relevant for paper 2.
  {E}: 1 or 2: distribution of P,Q|HP0 used for integration 
    over L-regions. 1 indicates the true distribution, 2 the
    estimated distribution parametrised by pi0_null,sigma_null,
    dist2.
  {F}: 1,2, or 3: fold, only relevant if C=3. Corresponds to
    within-fold FDP/TDR
  Also contains fdp_p (column 21) and tdr_p (column 118) 
    corresponding to FDP and TDR of the Benjamini-Hochberg 
    method applied to p-values.


### gwas_data.RData ###

This file contains two objects, gwas_results and corr_null. 
These contain summary statistics for JIA and T1D along with 
chromosome number and position (build 37) for all variants. 
Data were originally sourced from the ImmunoBase repository,
(www.immunobase.org) and have already undergone quality control 
and genomic control as per Liley et al 2015. The MHC region has 
been removed.

gwas_results contains columns
[1] JIA: p-values for JIA
[2] T1D: p-values for T1D
[3] CHR: chromosome of variant
[4] POS: position of variant (build 37)
Row names are RSIDs of SNPs

corr_null is the estimated correlation between Z_P and Z_Q 
under HP0 (see Liley et al 2015).


### gwas_cfdr_data.RData ###

This file is generated by the script ../code/analysis.R. It
contains the following objects used to perform the cFDR 
analysis

xsub: subset of SNPs for which L-regions/v-values are 
  calculated (names)
nullq_pars: fitted parameters of Z_Q|HP0
v_jia_t1d: v-values corresponding to xsub
Lcoords_jia_t1d: co-ordinates of L-regions corresponding to
  xsub. List with two elements x,y; co-ordinates for xsub[i]
  are given (on p-value scale) by
  Lcoords_jia_t1d$x[i,], Lcoords_jia_t1d$y.



